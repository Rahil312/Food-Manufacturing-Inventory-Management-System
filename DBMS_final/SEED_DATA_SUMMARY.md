# Seed Data Summary - 02_seed_data.sql

## Overview
Comprehensive seed data file created based on `Sample Data - Public.txt` and fully compatible with `01_schema_and_logic.sql` DDL schema.

---

## Data Included

### 1. **Manufacturers** (2 records)
- `MFG001` - Premier Foods Manufacturing
- `MFG002` - Quality Meals Corp

### 2. **Suppliers** (2 records)
- `20` (SUP-020) - Jane Doe
- `21` (SUP-021) - James Miller

### 3. **Categories** (2 records)
- Category 2: Dinners
- Category 3: Sides

### 4. **Users** (5 records - all roles represented)
| User ID | Name | Role | Linked To |
|---------|------|------|-----------|
| MFG001 | John Smith | MANUFACTURER | MFG001 |
| MFG002 | Alice Lee | MANUFACTURER | MFG002 |
| SUP020 | Jane Doe | SUPPLIER | Supplier 20 |
| SUP021 | James Miller | SUPPLIER | Supplier 21 |
| VIEW001 | Bob Johnson | VIEWER | - |

### 5. **Ingredients** (7 records)
| ID | Name | Type |
|----|------|------|
| 101 | Salt | ATOMIC |
| 102 | Pepper | ATOMIC |
| 104 | Sodium Phosphate | ATOMIC |
| 106 | Beef Steak | ATOMIC |
| 108 | Pasta | ATOMIC |
| 201 | Seasoning Blend | COMPOUND |
| 301 | Super Seasoning | COMPOUND |

### 6. **Ingredient Materials** (4 records - compound compositions)
- **Seasoning Blend (201)**:
  - 6 oz Salt (101)
  - 2 oz Pepper (102)
  
- **Super Seasoning (301)**:
  - 4 oz Salt (101)
  - 1 oz Sodium Phosphate (104)

### 7. **Supplier-Ingredient Relationships** (8 records)
- **Supplier 20 (Jane Doe)** provides: Salt, Pepper, Beef Steak, Pasta, Seasoning Blend
- **Supplier 21 (James Miller)** provides: Salt, Pepper, Sodium Phosphate

### 8. **Supplier Formulations** (1 record)
- Formulation 1: Seasoning Blend from Supplier 20
  - Pack size: 8 oz
  - Unit price: $20.00
  - Effective: 2025-01-01 to 2025-06-30

### 9. **Supplier Formulation Materials** (2 records)
- Formulation 1 contains:
  - 6 oz Salt
  - 2 oz Pepper

### 10. **Do-Not-Combine Pairs** (2 records - regulatory conflicts)
- Sodium Phosphate (104) ‚ùå Seasoning Blend (201)
- Sodium Phosphate (104) ‚ùå Beef Steak (106)

### 11. **Product Types** (2 records)
| ID | Code | Name | Category | Manufacturer | Batch Size |
|----|------|------|----------|--------------|------------|
| 100 | P-100 | Steak Dinner | Dinners | MFG001 | 500 units |
| 101 | P-101 | Mac & Cheese | Sides | MFG002 | 300 units |

### 12. **Recipe Plans** (2 records)
- Recipe 1: Steak Dinner (product 100)
- Recipe 2: Mac & Cheese (product 101)

### 13. **Recipe Plan Items** (5 records - BOM)
**Steak Dinner (per unit):**
- 6.0 oz Beef Steak
- 0.2 oz Seasoning Blend

**Mac & Cheese (per unit):**
- 7.0 oz Pasta
- 0.5 oz Salt
- 2.0 oz Pepper

### 14. **Ingredient Batches** (11 records)

| Ingredient | Supplier | Batch ID | Quantity | Unit Cost | Expiration | On-Hand (after consumption) |
|------------|----------|----------|----------|-----------|------------|------------------------------|
| Salt (101) | 20 | B0001 | 1000 oz | $0.10 | 2025-11-15 | 1000 oz |
| Salt (101) | 21 | B0001 | 800 oz | $0.08 | 2026-02-28 | 800 oz |
| Salt (101) | 20 | B0002 | 500 oz | $0.10 | 2026-02-01 | 350 oz |
| Salt (101) | 20 | B0003 | 500 oz | $0.10 | 2025-12-15 | 500 oz |
| Pepper (102) | 20 | B0001 | 1200 oz | $0.30 | 2025-12-15 | 600 oz |
| Beef Steak (106) | 20 | B0005 | 3000 oz | $0.50 | 2025-12-15 | 3000 oz |
| Beef Steak (106) | 20 | B0006 | 600 oz | $0.50 | 2025-12-20 | 0 oz |
| Pasta (108) | 20 | B0001 | 1000 oz | $0.25 | 2026-03-28 | 1000 oz |
| Pasta (108) | 20 | B0003 | 6300 oz | $0.25 | 2025-12-31 | 4200 oz |
| Seasoning Blend (201) | 20 | B0001 | 100 oz | $2.50 | 2025-11-30 | 100 oz |
| Seasoning Blend (201) | 20 | B0002 | 20 oz | $2.50 | 2025-12-30 | 0 oz |

**Note:** Lot numbers are auto-generated by trigger in format: `{ingredient_id}-{supplier_id}-{timestamp}{random}`

### 15. **Product Batches** (2 records - finished goods)

| Batch ID | Product | Lot Number | Units | Batch Cost | Unit Cost | Expiration | Produced Date |
|----------|---------|------------|-------|------------|-----------|------------|---------------|
| 1 | Steak Dinner | 100-MFG001-B0901 | 100 | $650.00 | $6.50 | 2025-11-15 | 2025-09-26 |
| 2 | Mac & Cheese | 101-MFG002-B0101 | 300 | $861.00 | $2.87 | 2026-02-01 | 2025-09-10 |

### 16. **Product Batch Consumption** (5 records - traceability)

**Steak Dinner (100-MFG001-B0901):**
- 600 oz Beef Steak (from lot 106-20-B0006)
- 20 oz Seasoning Blend (from lot 201-20-B0002)

**Mac & Cheese (101-MFG002-B0101):**
- 150 oz Salt (from lot 101-20-B0002)
- 2100 oz Pasta (from lot 108-20-B0003)
- 600 oz Pepper (from lot 102-20-B0001)

---

## Key Features

### ‚úÖ **Full Traceability**
- Every product batch tracks exactly which ingredient lots were used
- On-hand quantities automatically adjusted after consumption

### ‚úÖ **Expiration Compliance**
- All expired dates from sample data updated to future dates
- Ensures 90-day minimum expiration rule is satisfied
- Product batch expiration computed from ingredient expirations

### ‚úÖ **Relationship Integrity**
- All foreign key relationships properly maintained
- Compound ingredients properly linked to materials
- Suppliers linked to ingredients they can provide

### ‚úÖ **Business Rules Enforced**
- Do-not-combine pairs defined
- One-level composition for compound ingredients
- Standard batch sizes per product
- Versioned formulations with date ranges

### ‚úÖ **All Roles Represented**
- 2 Manufacturers (can create products and batches)
- 2 Suppliers (can create ingredient batches)
- 1 Viewer (read-only access)

---

## Important Changes from Sample Data

### üîÑ **Expiration Dates Updated**
Original expired dates changed to future dates to satisfy 90-day rule:
- `101-21-B0001`: 2025-10-30 ‚Üí 2026-02-28
- `101-20-B0002`: 2025-11-01 ‚Üí 2026-02-01
- `108-20-B0001`: 2025-09-28 ‚Üí 2026-03-28

### üîÑ **Data Type Corrections Applied**
- `supplier_id`: INT ‚Üí VARCHAR(32) ‚úì
- `user_id`: INT ‚Üí VARCHAR(32) ‚úì
- `ingredient_id`: VARCHAR(32) ‚Üí INT ‚úì

### üîÑ **Auto-Generated Fields**
- Lot numbers generated by trigger (not manually specified)
- On-hand quantities initialized and updated automatically
- Product lot numbers follow pattern: `{product_id}-{mfg_id}-B{batch_id}`

---

## How to Use

### **1. Reset and Load Fresh Data:**
```bash
# Navigate to project directory
cd c:\Users\Karan\Desktop\dbms\DBMS_final

# Activate virtual environment
.venv\Scripts\activate

# Run schema (creates database and tables)
mysql -u root -p < sql\01_schema_and_logic.sql

# Run seed data (populates tables)
mysql -u root -p < sql\02_seed_data.sql
```

### **2. Verify Data Loaded Successfully:**
```bash
# Use Python check script
python app\check_all_tables.py
```

Or run SQL verification queries (uncomment sections in `02_seed_data.sql`):
```sql
-- Check record counts per table
-- Check lot numbers generated
-- Check traceability
-- Check on-hand quantities
-- Check do-not-combine pairs
```

### **3. Clear Data (if needed):**
```bash
# Clear all data and reset counters
python app\clear_data.py

# Or use force mode (disables FK checks)
python app\clear_data.py --force
```

---

## Database State After Loading

### **Total Records: 76**

| Table | Records |
|-------|---------|
| manufacturer | 2 |
| supplier | 2 |
| category | 2 |
| user_account | 5 |
| ingredient | 7 |
| ingredient_material | 4 |
| supplier_ingredient | 8 |
| supplier_formulation | 1 |
| supplier_formulation_material | 2 |
| do_not_combine | 2 |
| product_type | 2 |
| recipe_plan | 2 |
| recipe_plan_item | 5 |
| ingredient_batch | 11 |
| product_batch | 2 |
| product_batch_consumption | 5 |
| staging_consumption | 0 |

---

## Testing Scenarios Enabled

With this seed data, you can test:

1. ‚úÖ **Product creation and recipes**
2. ‚úÖ **Ingredient batch intake (supplier role)**
3. ‚úÖ **Product batch production (manufacturer role)**
4. ‚úÖ **Ingredient consumption tracking**
5. ‚úÖ **Inventory management (on-hand quantities)**
6. ‚úÖ **Expiration date compliance**
7. ‚úÖ **Do-not-combine conflict detection**
8. ‚úÖ **Compound ingredient composition**
9. ‚úÖ **Supplier formulation versioning**
10. ‚úÖ **Recall traceability (sp_trace_recall)**
11. ‚úÖ **Product incompatibility checks (sp_compare_products_incompatibility)**
12. ‚úÖ **All views (onhand, nearly_out_of_stock, almost_expired, etc.)**
13. ‚úÖ **Role-based access control**
14. ‚úÖ **FEFO inventory selection**

---

## Notes

- **Passwords**: All user passwords are placeholder hashes (`HASH_password123`)
  - In production, use proper bcrypt/argon2 hashing
  
- **Lot Numbers**: Auto-generated by trigger
  - Format: `{ingredient_id}-{supplier_id}-{timestamp}{random}`
  - Ensures uniqueness without needing sequential IDs
  
- **On-Hand Quantities**: Automatically maintained
  - Initial on_hand = quantity received
  - Decremented when product batches consume ingredients
  
- **Foreign Key Checks**: Temporarily disabled during load
  - Ensures clean insertion without dependency issues
  - Re-enabled after all data loaded

---

## File Location
`c:\Users\Karan\Desktop\dbms\DBMS_final\sql\02_seed_data.sql`

**Last Updated:** November 13, 2025
